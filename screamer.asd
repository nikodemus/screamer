;;; -*- Lisp -*-
;;;
;;; Screamer - an extension of Common Lisp that adds support for
;;; nondeterministic programming

(defpackage #:screamer-system (:use #:asdf #:cl))
(in-package #:screamer-system)

(defclass file-warn-only (cl-source-file) ())

(defmethod perform :around ((op compile-op) (c file-warn-only))
  (setf (operation-on-failure op) :warn)
  (call-next-method))

(defsystem screamer
    :name "Screamer - an extension of Common Lisp that adds support for nondeterministic programming"
    :author "Jeffrey Mark Siskind & David Allen McAllester"
    :maintainer "Nikodemus Siivola, Chun Tian (binghe)"
    :version "3.24"
    :components
    (#+harlequin-common-lisp
     (:file "loop")
     (:file "screamer" :depends-on (#+harlequin-common-lisp "loop"))
     (:file "iterate")
     (:file "primordial" :depends-on ("iterate" "screamer"))
     ;;Permit four Duplicate definition warnings generated by SBCL
     (file-warn-only "screams" :depends-on ("iterate" "screamer"))
     (:file "equations" :depends-on ("iterate" "screamer")))
    
    :perform (compile-op :after (op c)
			 (print (funcall (intern
					  "PRIME-ORDEAL" "PRIMORDIAL")))))
